
ABC_army_effort = {

	VAT_disband_the_swiss_guard = {

		icon = GFX_decision_SWI_focus_on_swiss_unity

		priority = 10

		allowed = {
			original_tag = VAT
		}

		custom_cost_trigger = {
			command_power > 14
		}

		custom_cost_text = EGY_decision_cost_command_power

		available = {
			has_war = no
		}

		visible = {
			has_completed_focus = VAT_invite_foreign_noble_guards 
		}

		fire_only_once = yes

		ai_will_do = {
			base = 0
		}
		
		complete_effect = {
			add_command_power = -15
			swap_ideas = {
                remove_idea = VAT_foreign_noble_guards
                add_idea = VAT_foreign_noble_guards_2
            }
			delete_units = {
				division_template = "Pontificia Cohors Helvetica"
				disband = yes
			}
			retire_character = VAT_georg_von_sury_d_aspermont
		}
	}
}

VAT_will_of_the_pope_category = {

	VAT_excommunicate_country_decision = {
		priority = 50

		icon = GFX_decision_generic_speech # Get unique!

		ai_will_do = {
			base = 0.5
			modifier = {
				factor = 1.5
				has_political_power > 160
			}
			modifier = {
				factor = 20
				FROM = { has_added_tension_amount > 10 }
			}
		}

		target_trigger = {
			VAT_excommunication_trigger = yes
		}

		target_root_trigger = {
			#has_completed_focus = VAT_divine_will_of_the_pope
			is_subject = no
		}

		allowed = {
			original_tag = VAT
		}

		visible = {
			has_completed_focus = VAT_divine_will_of_the_pope
		}

		available = {
			is_subject = no
			NOT = {
				has_global_flag = VAT_pope_excommunicated_recently
			}
		}

		fire_only_once = no

		cost = 50

		complete_effect = {
			VAT_excommunicate_country = yes
			set_country_flag = {
				flag = VAT_pope_excommunicated_recently
				days = 90
			}
		}
	}
	VAT_repeal_excommunicate_country_decision = {
		priority = 50

		icon = GFX_decision_generic_speech

		ai_will_do = {
			base = 0.5
			modifier = {
				factor = 5
				has_political_power > 160
			}
			modifier = {
				factor = 15
				has_opinion = {
					target = FROM
					value > 49
				}
			}
		}

		target_trigger = {
			FROM = {
				has_country_flag = VAT_we_are_excommunicated
			}
		}

		target_root_trigger = {
			#has_completed_focus = VAT_divine_will_of_the_pope
			is_subject = no
		}

		allowed = {
			original_tag = VAT
		}

		visible = {
			has_completed_focus = VAT_divine_will_of_the_pope
		}

		available = {
			is_subject = no
			NOT = {
				has_global_flag = VAT_pope_excommunicated_recently
			}
		}

		fire_only_once = no

		cost = 50

		complete_effect = {
			VAT_repeal_excommunicate_country = yes
			set_country_flag = {
				flag = VAT_pope_excommunicated_recently
				days = 30
			}
		}
	}

}

VAT_papal_breakout_category = {

	VAT_gods_condonement = { # Just needed something to show the category to be honest

		icon = GFX_decision_eng_propaganda_campaigns

		priority = 10

		allowed = {
			original_tag = VAT
		}

		cost = 50

		available = {
			is_subject = no
		}

		visible = {
			has_completed_focus = VAT_a_holy_breakout
			original_tag = VAT
			NOT = {
				has_completed_focus = VAT_avenge_the_risorgimento
			}
		}

		days_remove = 30

		days_reenable = 90

		modifier = {
			war_support_weekly = 0.001
			army_core_defence_factor = 0.05
			army_core_attack_factor = 0.05
		}

		ai_will_do = {
			base = 0
		}
		
		complete_effect = {
			
		}
	}

	VAT_expand_influence_in_the_lazio_garrison = {

		icon = {
			key = spa_garrison_control_none
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				2 = { check_variable = { var = VAT_garrison_control value = 1 compare = equals } }
			}
		}
		icon = {
			key = spa_garrison_control_weak
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				2 = { check_variable = { var = VAT_garrison_control value = 2 compare = equals } }
			}
		}
		icon = {
			key = spa_garrison_control_strong
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				2 = { check_variable = { var = VAT_garrison_control value = 3 compare = equals } }
			}
		}
		icon = {
			key = spa_garrison_control_total
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				2 = { check_variable = { var = VAT_garrison_control value = 4 compare = greater_than_or_equals } }
			}
		}

		allowed = {
			original_tag = VAT
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = VAT_expand_influence_trigger_tt
				2 = { check_variable = { var = VAT_garrison_control value = 4 compare = less_than } }
			}
			NOT = {
				has_country_flag = VAT_already_expanding_influence_flag
			}
		}

		highlight_states = {
			highlight_state_targets = {
				state = 2
			} 
		}

		on_map_mode = map_only

		cost = 2.VAT_garrison_control_cost?10

		fire_only_once = no

		days_remove = 14

		visible = {
			NOT = { has_global_flag = VAT_vatican_war_started }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = VAT_already_expanding_influence_flag
		}

		remove_effect = {
			2 = {
				custom_effect_tooltip = VAT_expand_influence_tt
				VAT_garrison_control_calculation = yes
				VAT_garrison_control_tooltip = yes
				VAT_garrison_control_cost_calculation = yes
			}
			clr_country_flag = VAT_already_expanding_influence_flag
		}

		ai_will_do = {
			base = 110
			modifier = {
				2 = { has_state_flag = VAT_recently_expanded_influence_flag }
				factor = 10
			}
			modifier = {
				2 = { check_variable = { var = VAT_garrison_control value = 2 compare = greater_than_or_equals } }
				factor = 5
			}
			modifier = {
				2 = { check_variable = { var = VAT_garrison_control value = 3 compare = greater_than_or_equals } }
				factor = 5
			}
		}
	}

	VAT_expand_influence_in_the_umbria_garrison = {

		icon = {
			key = spa_garrison_control_none
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				1024 = { check_variable = { var = VAT_garrison_control value = 1 compare = equals } }
			}
		}
		icon = {
			key = spa_garrison_control_weak
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				1024 = { check_variable = { var = VAT_garrison_control value = 2 compare = equals } }
			}
		}
		icon = {
			key = spa_garrison_control_strong
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				1024 = { check_variable = { var = VAT_garrison_control value = 3 compare = equals } }
			}
		}
		icon = {
			key = spa_garrison_control_total
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				1024 = { check_variable = { var = VAT_garrison_control value = 4 compare = greater_than_or_equals } }
			}
		}

		allowed = {
			original_tag = VAT
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = VAT_expand_influence_trigger_tt
				1024 = { check_variable = { var = VAT_garrison_control value = 4 compare = less_than } }
			}
			NOT = {
				has_country_flag = VAT_already_expanding_influence_flag
			}
		}

		highlight_states = {
			highlight_state_targets = {
				state = 1024
			} 
		}

		on_map_mode = map_only

		cost = 2.VAT_garrison_control_cost?10

		fire_only_once = no

		days_remove = 14

		visible = {
			NOT = { has_global_flag = VAT_vatican_war_started }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = VAT_already_expanding_influence_flag
		}

		remove_effect = {
			1024 = {
				custom_effect_tooltip = VAT_expand_influence_tt
				VAT_garrison_control_calculation = yes
				VAT_garrison_control_tooltip = yes
				VAT_garrison_control_cost_calculation = yes
			}
			clr_country_flag = VAT_already_expanding_influence_flag
		}

		ai_will_do = {
			base = 110
			modifier = {
				1024 = { has_state_flag = VAT_recently_expanded_influence_flag }
				factor = 10
			}
			modifier = {
				1024 = { check_variable = { var = VAT_garrison_control value = 2 compare = greater_than_or_equals } }
				factor = 5
			}
			modifier = {
				1024 = { check_variable = { var = VAT_garrison_control value = 3 compare = greater_than_or_equals } }
				factor = 5
			}
		}
	}

	VAT_expand_influence_in_the_marche_garrison = {

		icon = {
			key = spa_garrison_control_none
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				957 = { check_variable = { var = VAT_garrison_control value = 1 compare = equals } }
			}
		}
		icon = {
			key = spa_garrison_control_weak
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				957 = { check_variable = { var = VAT_garrison_control value = 2 compare = equals } }
			}
		}
		icon = {
			key = spa_garrison_control_strong
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				957 = { check_variable = { var = VAT_garrison_control value = 3 compare = equals } }
			}
		}
		icon = {
			key = spa_garrison_control_total
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				957 = { check_variable = { var = VAT_garrison_control value = 4 compare = greater_than_or_equals } }
			}
		}

		allowed = {
			original_tag = VAT
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = VAT_expand_influence_trigger_tt
				957 = { check_variable = { var = VAT_garrison_control value = 4 compare = less_than } }
			}
			NOT = {
				has_country_flag = VAT_already_expanding_influence_flag
			}
		}

		highlight_states = {
			highlight_state_targets = {
				state = 957
			} 
		}

		on_map_mode = map_only

		cost = 2.VAT_garrison_control_cost?10

		fire_only_once = no

		days_remove = 14

		visible = {
			NOT = { has_global_flag = VAT_vatican_war_started }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = VAT_already_expanding_influence_flag
		}

		remove_effect = {
			957 = {
				custom_effect_tooltip = VAT_expand_influence_tt
				VAT_garrison_control_calculation = yes
				VAT_garrison_control_tooltip = yes
				VAT_garrison_control_cost_calculation = yes
			}
			clr_country_flag = VAT_already_expanding_influence_flag
		}

		ai_will_do = {
			base = 110
			modifier = {
				957 = { has_state_flag = VAT_recently_expanded_influence_flag }
				factor = 10
			}
			modifier = {
				957 = { check_variable = { var = VAT_garrison_control value = 2 compare = greater_than_or_equals } }
				factor = 5
			}
			modifier = {
				957 = { check_variable = { var = VAT_garrison_control value = 3 compare = greater_than_or_equals } }
				factor = 5
			}
		}
	}

	VAT_expand_influence_in_the_emilia_romagna_garrison = {

		icon = {
			key = spa_garrison_control_none
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				161 = { check_variable = { var = VAT_garrison_control value = 1 compare = equals } }
			}
		}
		icon = {
			key = spa_garrison_control_weak
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				161 = { check_variable = { var = VAT_garrison_control value = 2 compare = equals } }
			}
		}
		icon = {
			key = spa_garrison_control_strong
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				161 = { check_variable = { var = VAT_garrison_control value = 3 compare = equals } }
			}
		}
		icon = {
			key = spa_garrison_control_total
			trigger = {
				has_completed_focus = VAT_papal_infiltration
				161 = { check_variable = { var = VAT_garrison_control value = 4 compare = greater_than_or_equals } }
			}
		}

		allowed = {
			original_tag = VAT
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = VAT_expand_influence_trigger_tt
				161 = { check_variable = { var = VAT_garrison_control value = 4 compare = less_than } }
			}
			NOT = {
				has_country_flag = VAT_already_expanding_influence_flag
			}
		}

		highlight_states = {
			highlight_state_targets = {
				state = 161
			} 
		}

		on_map_mode = map_only

		cost = 2.VAT_garrison_control_cost?10

		fire_only_once = no

		days_remove = 14

		visible = {
			NOT = { has_global_flag = VAT_vatican_war_started }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = VAT_already_expanding_influence_flag
		}

		remove_effect = {
			161 = {
				custom_effect_tooltip = VAT_expand_influence_tt
				VAT_garrison_control_calculation = yes
				VAT_garrison_control_tooltip = yes
				VAT_garrison_control_cost_calculation = yes
			}
			clr_country_flag = VAT_already_expanding_influence_flag
		}

		ai_will_do = {
			base = 110
			modifier = {
				161 = { has_state_flag = VAT_recently_expanded_influence_flag }
				factor = 10
			}
			modifier = {
				161 = { check_variable = { var = VAT_garrison_control value = 2 compare = greater_than_or_equals } }
				factor = 5
			}
			modifier = {
				161 = { check_variable = { var = VAT_garrison_control value = 3 compare = greater_than_or_equals } }
				factor = 5
			}
		}
	}

}




