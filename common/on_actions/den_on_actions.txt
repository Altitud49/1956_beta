on_actions = {
	on_monthly = {
		effect = {
			#
			# (E-L)/4 ~ diff/month
			# (50-75)/4 = -6.25 ~ -6
			# (50-20)/4 = 7.5 ~ 8
			#
			if = {
				limit = {
					tag = DEN
					den_stratas_enabled = yes
				}
				add_to_variable = {
					den_upper_loyalty = den_upper_diff
				}
				add_to_variable = {
					den_middle_loyalty = den_middle_diff
				}
				add_to_variable = {
					den_lower_loyalty = den_lower_diff
				}

				set_variable = {
					den_upper_diff = den_upper_equilibrium
				}
				subtract_from_variable = {
					den_upper_diff = den_upper_loyalty
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								den_upper_diff = 1
							}
							check_variable = {
								den_upper_diff = -1
							}
						}
					}
					divide_variable = {
						den_upper_diff = den_loyalty_decay
					}
				}
				if = {
					limit = {
						check_variable = {
							den_upper_diff < 2
						}
						check_variable = {
							den_upper_diff > 1
						}
					}
					set_variable = {
						den_upper_diff = 2
					}
				}
				else_if = {
					limit = {
						check_variable = {
							den_upper_diff > -2
						}
						check_variable = {
							den_upper_diff < 1
						}
					}
					set_variable = {
						den_upper_diff = -2
					}
				}
				round_variable = den_upper_diff

				
				set_variable = {
					den_middle_diff = den_middle_equilibrium
				}
				subtract_from_variable = {
					den_middle_diff = den_middle_loyalty
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								den_middle_diff = 1
							}
							check_variable = {
								den_middle_diff = -1
							}
						}
					}
					divide_variable = {
						den_middle_diff = den_loyalty_decay
					}
				}
				if = {
					limit = {
						check_variable = {
							den_middle_diff < 2
						}
						check_variable = {
							den_middle_diff > 1
						}
					}
					set_variable = {
						den_middle_diff = 2
					}
				}
				else_if = {
					limit = {
						check_variable = {
							den_middle_diff > -2
						}
						check_variable = {
							den_middle_diff < 1
						}
					}
					set_variable = {
						den_middle_diff = -2
					}
				}
				round_variable = den_middle_diff

				
				set_variable = {
					den_lower_diff = den_lower_equilibrium
				}
				subtract_from_variable = {
					den_lower_diff = den_lower_loyalty
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								den_lower_diff = 1
							}
							check_variable = {
								den_lower_diff = -1
							}
						}
					}
					divide_variable = {
						den_lower_diff = den_loyalty_decay
					}
				}
				if = {
					limit = {
						check_variable = {
							den_lower_diff < 2
						}
						check_variable = {
							den_lower_diff > 1
						}
					}
					set_variable = {
						den_lower_diff = 2
					}
				}
				else_if = {
					limit = {
						check_variable = {
							den_lower_diff > -2
						}
						check_variable = {
							den_lower_diff < 1
						}
					}
					set_variable = {
						den_lower_diff = -2
					}
				}
				round_variable = den_lower_diff
				den_calculate_stratas = yes
			}
		}
	}
	on_capitulation = {
		effect = {
			if = {
				limit = {
					tag = event_target:den_scw_volunteers_received
					original_tag = SPR
				}
				DEN = {
					add_manpower = 400 #TODO EVENT
				}

			}
			if = {
				limit = {
					tag = DEN
					has_government = democratic
					FROM = {
						has_government = fascism
						#tag = GER
					}
				}
				country_event = {
					id = denmark.2
					hours = 0
				}
			}
			if = {
				limit = {
					original_tag = DEN
					OR = {
						ICE = { is_subject_of = DEN }
						DEN = { owns_state = 100 }
						ICE = { owns_state = 100 }
					}
					NOR = {
						NOT = {
							has_completed_focus = NOR_reclaim_the_islands
							has_completed_focus = NOR_icelandic-faroese_revolt
							has_completed_focus = NOR_reclaim_danish
							has_completed_focus = NOR_unite_the_scandinavian_workers
						}
					}
				}
				country_event = { id = wtt_denmark.1 days = 1 }
			}
		}
	}
}