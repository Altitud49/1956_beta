r56_bundeslaender_civil_war_outbreak = {
	add_dynamic_modifier = {
		modifier = r56_bundeslaender_status
	}
	if = {
		limit = {
			1 = { r56_bundeslaender_current_loyal = yes }
			2 = { r56_bundeslaender_current_loyal = yes }
			3 = { r56_bundeslaender_current_loyal = yes }
			4 = { r56_bundeslaender_current_loyal = yes }
			5 = { r56_bundeslaender_current_loyal = yes }
			AUS = { r56_bundeslaender_current_loyal = yes }
		}
		add_political_power = 1
	}
	load_oob = AUS_schutzbund
	r56_bundeslaender_burgenland_outbreak = yes
	r56_bundeslaender_kaernten_outbreak = yes
	r56_bundeslaender_niederoesterreich_outbreak = yes
	r56_bundeslaender_oberoesterreich_outbreak = yes
	r56_bundeslaender_salzburg_outbreak = yes
	r56_bundeslaender_steiermark_outbreak = yes
	r56_bundeslaender_tirol_outbreak = yes
	r56_bundeslaender_vorarlberg_outbreak = yes
	r56_bundeslaender_wien_outbreak = yes
	for_loop_effect = {
		end = 9
		value = temp
		if = {
			limit = { 
				OR = {
					NOT = { check_variable = { temp = 6 } }
					owns_state = 39
				}
			}
			set_variable = { r56_bundeslaender_current = temp }
			r56_bundeslaender_dynamic_modifier_calculation = yes
			r56_bundeslaender_loyalty_calculation = yes
		}
	}
	set_variable = { r56_bundeslaender_current = -1 }
}
r56_bundeslaender_switch_alliegence = {
	meta_effect = {
		text = {
			set_variable = { r56_bundeslaender_[BNDLND]_frame = r56_bundeslaender_current_loyalty }
		}
		BNDLND = "[r56_bundeslaender_index]"
	}
	r56_bundeslaender_dynamic_modifier_calculation = yes
	r56_bundeslaender_loyalty_calculation = yes
}
r56_bundeslaender_amplitude_calculation = {	#-0.75	#on a scale from -1 to 0; 0 meaning no negative effects; 1 meaning maximum negative effects GLOBAL
	set_variable = {
		r56_bundeslaender_amplitude = r56_bundeslaender_balance
	}
	multiply_variable = {
		r56_bundeslaender_amplitude = -0.01
	}
}	
r56_bundeslaender_dynamic_modifier_calculation = {
	meta_effect = { # calculation for r56_bundeslaender_current bundesland
		text = {
			if = {
				limit = { check_variable = { r56_[BNDLND]_loyalty > 0 } }
				add_to_variable = { r56_bundeslaender_val = 1 }	#if loyalty is positive add 1 (from -0.75 to 0.25 of a modifier)
			}
			set_temp_variable = {
				r56_bundeslaender_val = [LNDMAX]
			}
			multiply_temp_variable = {
				r56_bundeslaender_val = r56_bundeslaender_amplitude
			}
			set_variable = {
				[BNDLND]_dyn = r56_bundeslaender_val
			}	
		}
		BNDLND = "[r56_bundeslaender_index]" # Gets the string for the selected bundesland
		LNDMAX = "[r56_bundeslaender_max]"	# Gets the maximum value the modifier of the selected bundesland can be
	}
	if = {
		limit = { NOT  = { owns_state = 39 } }
		clear_variable = suedtirol_dyn
	}
}
r56_bundeslaender_loyalty_calculation = {
	meta_effect = { # calculation for r56_bundeslaender_current bundesland
		text = {
			if = {
				limit = { has_country_flag = austrian_pre_coup_powerstruggle }
				if = {
					limit = { check_variable = { r56_bundeslaender_[BNDLND]_frame = 1 } }
					set_variable = { r56_[BNDLND]_loyalty = 1 }
				}
				else_if = {
					limit = { check_variable = { r56_bundeslaender_[BNDLND]_frame = 2 } }
					set_variable = { r56_[BNDLND]_loyalty = -1 }
				}
				else = {
					set_variable = { r56_[BNDLND]_loyalty = 0 }
				}
			}
			else = {

			}
		}
		BNDLND = "[r56_bundeslaender_index]" # Gets the string for the selected bundesland
	}
	if = {
		limit = {
			has_country_flag = austrian_pre_coup_powerstruggle
		}
		r56_bundeslaender_calculate_divisions = yes
	}
}
r56_bundeslaender_calculate_divisions = {
	clear_variable = r56_bundeslaender_divisions_DEM
	clear_variable = r56_bundeslaender_divisions_VF
	if = {
		limit = { check_variable = { r56_bundeslaender_burgenland_frame = 1 } }
		add_to_variable = { r56_bundeslaender_divisions_DEM = 1 }
	}
	else_if = {
		limit = { check_variable = { r56_bundeslaender_burgenland_frame = 2 } }
		add_to_variable = { r56_bundeslaender_divisions_VF = 1 }
	}

	
	if = {
		limit = { check_variable = { r56_bundeslaender_kaernten_frame = 1 } }
		add_to_variable = { r56_bundeslaender_divisions_DEM = 2 }
	}
	else_if = {
		limit = { check_variable = { r56_bundeslaender_kaernten_frame = 2 } }
		add_to_variable = { r56_bundeslaender_divisions_VF = 2 }
	}

	
	if = {
		limit = { check_variable = { r56_bundeslaender_niederoesterreich_frame = 1 } }
		add_to_variable = { r56_bundeslaender_divisions_DEM = 3 }
	}
	else_if = {
		limit = { check_variable = { r56_bundeslaender_niederoesterreich_frame = 2 } }
		add_to_variable = { r56_bundeslaender_divisions_VF = 3 }
	}

	
	if = {
		limit = { check_variable = { r56_bundeslaender_oberoesterreich_frame = 1 } }
		add_to_variable = { r56_bundeslaender_divisions_DEM = 2 }
	}
	else_if = {
		limit = { check_variable = { r56_bundeslaender_oberoesterreich_frame = 2 } }
		add_to_variable = { r56_bundeslaender_divisions_VF = 2 }
	}

	
	if = {
		limit = { check_variable = { r56_bundeslaender_salzburg_frame = 1 } }
		add_to_variable = { r56_bundeslaender_divisions_DEM = 2 }
	}
	else_if = {
		limit = { check_variable = { r56_bundeslaender_salzburg_frame = 2 } }
		add_to_variable = { r56_bundeslaender_divisions_VF = 2 }
	}

	
	if = {
		limit = { check_variable = { r56_bundeslaender_steiermark_frame = 1 } }
		add_to_variable = { r56_bundeslaender_divisions_DEM = 2 }
	}
	else_if = {
		limit = { check_variable = { r56_bundeslaender_steiermark_frame = 2 } }
		add_to_variable = { r56_bundeslaender_divisions_VF = 2 }
	}

	
	if = {
		limit = { check_variable = { r56_bundeslaender_tirol_frame = 1 } }
		add_to_variable = { r56_bundeslaender_divisions_DEM = 3 }
	}
	else_if = {
		limit = { check_variable = { r56_bundeslaender_tirol_frame = 2 } }
		add_to_variable = { r56_bundeslaender_divisions_VF = 3 }
	}

	
	if = {
		limit = { check_variable = { r56_bundeslaender_vorarlberg_frame = 1 } }
		add_to_variable = { r56_bundeslaender_divisions_DEM = 1 }
	}
	else_if = {
		limit = { check_variable = { r56_bundeslaender_vorarlberg_frame = 2 } }
		add_to_variable = { r56_bundeslaender_divisions_VF = 1 }
	}

	
	if = {
		limit = { check_variable = { r56_bundeslaender_wien_frame = 1 } }
		add_to_variable = { r56_bundeslaender_divisions_DEM = 2 }
	}
	else_if = {
		limit = { check_variable = { r56_bundeslaender_wien_frame = 2 } }
		add_to_variable = { r56_bundeslaender_divisions_VF = 2 }
	}
}
r56_bundeslaender_burgenland_outbreak = {
	4 = {
		create_unit = {
			division = "name = \"Burgenländischer Schutzbund 'Heiliger Martin'\" division_template = \"Jägerspezialisierter Schutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 3700
			id = 3601
		}
	}
}
r56_bundeslaender_kaernten_outbreak = {
	153 = {
		create_unit = {
			division = "name = \"1. Kärntner Schutzbund 'Heiliger Josef'\" division_template = \"Jägerspezialisierter Schutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 3673
			id = 3611
		}
		create_unit = {
			division = "name = \"2. Kärntner Schutzbund 'Ernst der Eiserne'\" division_template = \"Jägerspezialisierter Schutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 3674
			id = 3612
		}
	}
}
r56_bundeslaender_niederoesterreich_outbreak = {
	4 = {
		create_unit = {
			division = "name = \"1. Niederösterreichischer Schutzbund 'Heiliger Leopold'\" division_template = \"Schutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 704
			id = 3621
		}
		create_unit = {
			division = "name = \"2. Niederösterreichischer Schutzbund 'Leopold V'\" division_template = \"Schutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 6690
			id = 3622
		}
		create_unit = {
			division = "name = \"Schnelle Brigade 'Heinrich von Bellegarde'\" division_template = \"Schnelle Brigade\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 6690
			id = 3623
		}
	}
}
r56_bundeslaender_oberoesterreich_outbreak = {
	152 = {
		create_unit = {
			division = "name = \"1. Oberösterreichischer Schutzbund 'Heiliger Florian'\" division_template = \"Schutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 6708
			id = 3631
		}
		create_unit = {
			division = "name = \"2. Oberösterreichischer Schutzbund 'Radetzky'\" division_template = \"Schutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 11651
			id = 3632
		}
	}
}
r56_bundeslaender_salzburg_outbreak = {
	152 = {
		create_unit = {
			division = "name = \"1. Salzburger Schutzbund 'Heiliger Rupert'\" division_template = \"Gebirgsschutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 688
			id = 3641
		}
	}
	153 = {
		create_unit = {
			division = "name = \"2. Salzburger Schutzbund 'Erzherzog Rainer'\" division_template = \"Gebirgsschutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 3675
			id = 3642
		}
	}
}
r56_bundeslaender_steiermark_outbreak = {
	4 = {
		create_unit = {
			division = "name = \"1. Steirischer Schutzbund 'Otakar IV'\" division_template = \"Artelleriegestützter Schutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 9648
			id = 3651
		}
		create_unit = {
			division = "name = \"2. Steirischer Schutzbund 'Peter Rosegger'\" division_template = \"Artelleriegestützter Schutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 653
			id = 3652
		}
	}
}
r56_bundeslaender_tirol_outbreak = {
	153 = {
		create_unit = {
			division = "name = \"1. Tiroler Schutzbund 'Heiliger Georg'\" division_template = \"Gebirgsschutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 673
			id = 3661
		}
		create_unit = {
			division = "name = \"2. Tiroler Schutzbund 'Adalbert I'\" division_template = \"Gebirgsschutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 153
			id = 3662
		}
		create_unit = {
			division = "name = \"3. Tiroler Schutzbund 'Michael Gaismair'\" division_template = \"Gebirgsschutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 9633
			id = 3663
		}
	}
}
r56_bundeslaender_vorarlberg_outbreak = {
	848 = {
		create_unit = {
			division = "name = \"1. Vorarlberger Schutzbund 'Michael Beer'\" division_template = \"Artelleriegestützter Schutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 6678
			id = 3671
		}
	}
}
r56_bundeslaender_wien_outbreak = {
	4 = {
		create_unit = {
			division = "name = \"1. Wiener Schutzbund 'Adolf Fischhof'\" division_template = \"Artelleriegestützter Schutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 11666
			id = 3681
		}
		create_unit = {
			division = "name = \"2. Wiener Schutzbund 'Koloman Wallisch'\" division_template = \"Artelleriegestützter Schutzbund\" start_manpower_factor = 0.9 start_equipment_factor = 0.6"
			owner = AUS
			count = 1
			allow_spawning_on_enemy_provs = yes
			prioritize_location = 11666
			id = 3682
		}
	}
}
