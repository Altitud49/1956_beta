
# 

VAT_excommunicate_country = {
	send_embargo = FROM
	every_other_country = {
		limit = {
			NOT = {
				has_government = communism
				is_in_faction_with = FROM
				is_subject_of = PREV
			}
			capital_scope = {
				OR = {
					is_on_continent = europe
					is_on_continent = south_america
					is_on_continent = north_america
				}
			}
		}
		add_opinion_modifier = { target = FROM modifier = VAT_excommunication_om }
	}
	add_opinion_modifier = { target = FROM modifier = hostile_status }
	FROM = {
		set_country_flag = VAT_we_are_excommunicated
	}
}

VAT_excommunicate_country_alt = {
	every_other_country = {
		limit = {
			NOT = {
				has_government = communism
				is_in_faction_with = PREV
				is_subject_of = PREV
			}
			capital_scope = {
				OR = {
					is_on_continent = europe
					is_on_continent = south_america
					is_on_continent = north_america
				}
			}
		}
		add_opinion_modifier = { target = PREV modifier = VAT_excommunication_om }
	}
	add_opinion_modifier = { target = PREV modifier = hostile_status }
	PREV = {
		set_country_flag = VAT_we_are_excommunicated
	}
}

#War
VAT_garrison_control_tooltip = {
	if = {
		limit = {
			check_variable = { var = VAT_garrison_control value = 1 compare = equals }
		}
		custom_effect_tooltip = VAT_garrison_control_none_tt
	}
	if = {
		limit = {
			check_variable = { var = VAT_garrison_control value = 2 compare = equals }
		}
		custom_effect_tooltip = VAT_garrison_control_weak_tt
	}
	if = {
		limit = {
			check_variable = { var = VAT_garrison_control value = 3 compare = equals }
		}
		custom_effect_tooltip = VAT_garrison_control_strong_tt
		custom_effect_tooltip = VAT_garrison_in_our_control_tt
	}
	if = {
		limit = {
			check_variable = { var = VAT_garrison_control value = 4 compare = equals }
		}
		custom_effect_tooltip = VAT_garrison_control_total_tt
		custom_effect_tooltip = VAT_garrison_in_our_control_tt
	}
}

VAT_garrison_control_calculation = {
	if = {
		limit = { check_variable = { VAT_garrison_control < 4 } }
		add_to_variable = { var = VAT_garrison_control value = 1 }
	}
	if = {
		limit = { check_variable = { VAT_garrison_control > 1 } }
		set_state_flag = VAT_garrison_in_our_control
	}
	if = {
		limit = { 
			check_variable = { VAT_garrison_control < 2 } 
			has_state_flag = VAT_garrison_in_our_control
		}
		clr_state_flag = VAT_garrison_in_our_control
	}
}

VAT_garrison_control_cost_calculation = {
	if = {
		limit = {
			check_variable = { var = VAT_garrison_control value = 1 compare = equals }
		}
		set_variable = { var = VAT_garrison_control_cost value = 10 }
	}
	if = {
		limit = {
			check_variable = { var = VAT_garrison_control value = 2 compare = equals }
		}
		set_variable = { var = VAT_garrison_control_cost value = 20 }
	}
	if = {
		limit = {
			check_variable = { var = VAT_garrison_control value = 3 compare = equals }
		}
		set_variable = { var = VAT_garrison_control_cost value = 30 }
	}
}


