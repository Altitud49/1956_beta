add_namespace = GER_provisional_government
add_namespace = GER_first_elections
add_namespace = GER_question_of_parties
add_namespace = GER_sapd_left_opposition
add_namespace = GER_stance_on_versailles

country_event = {
	id = GER_provisional_government.1
	title = GER_provisional_government.1.t
	desc = GER_provisional_government.1.desc
	picture = GFX_reichstag_destroyed

	is_triggered_only = yes

	option = {
		name = GER_provisional_government.1.option1
		add_stability = 0.05
		add_war_support = -0.10
		add_political_power = 50
		hidden_effect = {
			add_dynamic_modifier = { modifier = GER_damaged_industry }
		}
		custom_effect_tooltip = add_reconstruction_tt
	}
}

country_event = {
	id = GER_question_of_parties.1
	title = GER_question_of_parties.1.t
	desc = GER_question_of_parties.1.desc
	picture = GFX_ballot

	is_triggered_only = yes

	option = {
		name = GER_question_of_parties.1.ban_extremist
		set_country_flag = dnvp_banned
		set_country_flag = dvp_banned
		set_country_flag = sapd_banned
		custom_effect_tooltip = GER_question_of_parties.1.ban_extremist_tt
	}
	option = {
		name = GER_question_of_parties.1.ban_dvp_dnvp
		set_country_flag = dnvp_banned
		set_country_flag = dvp_banned
		custom_effect_tooltip = GER_question_of_parties.1.ban_dvp_dnvp_tt
	}
	option = {
		name = GER_question_of_parties.1.ban_dnvp
		set_country_flag = dnvp_banned
		custom_effect_tooltip = GER_question_of_parties.1.ban_dnvp_tt
	}
	option = {
		name = GER_question_of_parties.1.no_bans
		custom_effect_tooltip = GER_question_of_parties.1.no_ban_tt
	}
}

country_event = {
	id = GER_first_elections.1
	title = GER_first_elections.1.t
	desc = GER_first_elections.1.desc
	picture = GFX_election_posters

	is_triggered_only = yes

	option = {
		trigger = {
			has_country_flag = GER_sapd_majority
			NOT = {
				has_country_flag = sapd_banned
			}
		}
		name = GER_first_elections.1.sapd
		set_country_flag = GER_sapd_victory_f
		set_politics = {
			ruling_party = democratic
			election_frequency = 48
			long_name = GER_rework_sapd_long
			name = GER_rework_sapd
		}
		if = {
			limit = {
				has_country_leader = {
					character = GER_erwin_von_witzleben
					ruling_only = yes	
				}
				amount_taken_ideas = {
					amount > 0
					slots = {
						army_chief
					}
				}
			}
			GER_erwin_von_witzleben={
				promote_leader = yes
				add_unit_leader_trait = offensive_doctrine
				add_trait = {						#vanilla does it now - Fantom
					trait = army_chief_offensive_1
					slot = army_chief
				}
				remove_country_leader_role = {
					ideology = conservatism
				}
			}
		}
		if = {
			limit = {
				has_country_leader = {
					character = GER_erwin_von_witzleben
					ruling_only = yes						
				}
				amount_taken_ideas = {
					amount < 1
					slots = {
						army_chief
					}
				}						
			}
			GER_erwin_von_witzleben={
				promote_leader = yes
				add_unit_leader_trait = offensive_doctrine
				add_trait = {						#vanilla does it now - Fantom
					trait = army_chief_offensive_1
					slot = army_chief
				}
				remove_country_leader_role = {
					ideology = conservatism
				}
			}
		}			
		GER_willy_brandt = {
			promote_character = yes
			promote_character = sapd_democratic_socialism
		}
	}
	option = {
		trigger = {
			has_country_flag = GER_spd_majority
		}
		name = GER_first_elections.1.spd
		set_country_flag = GER_spd_victory_f
		set_politics = {
			ruling_party = democratic
			election_frequency = 48
			long_name = GER_rework_spd_long
			name = GER_rework_spd
		}
	}
	option = {
		trigger = {
			has_country_flag = GER_dstp_majority
		}
		name = GER_first_elections.1.dstp
		set_country_flag = GER_dstp_victory_f
		set_politics = {
			ruling_party = democratic
			election_frequency = 48
			long_name = GER_rework_dstp_long
			name = GER_rework_dstp
		}
	}
	option = {
		trigger = {
			has_country_flag = GER_zentrum_majority
		}
		name = GER_first_elections.1.zentrum
		set_country_flag = GER_zentrum_victory_f
		set_politics = {
			ruling_party = democratic
			election_frequency = 48
			long_name = GER_rework_zentrum_long
			name = GER_rework_zentrum
		}
	}
	option = {
		trigger = {
			has_country_flag = GER_bvp_majority
		}
		name = GER_first_elections.1.bvp
		set_country_flag = GER_bvp_victory_f
		set_politics = {
			ruling_party = democratic
			election_frequency = 48
			long_name = GER_rework_bvp_long
			name = GER_rework_bvp
		}
	}
	option = {
		trigger = {
			has_country_flag = GER_dvp_majority
			NOT = {
				has_country_flag = dvp_banned
			}
		}
		name = GER_first_elections.1.dvp
		set_country_flag = GER_dvp_victory
		set_politics = {
			ruling_party = democratic
			election_frequency = 48
			long_name = GER_rework_dvp_long
			name = GER_rework_dvp
		}
	}
	option = {
		trigger = {
			has_country_flag = GER_dnvp_majority
			NOT = {
				has_country_flag = dnvp_banned
			}
		}
		name = GER_first_elections.1.dnvp
		set_country_flag = GER_dnvp_victory_f
		set_politics = {
			ruling_party = neutrality
			election_frequency = 48
			long_name = GER_rework_dnvp_long
			name = GER_rework_dnvp
		}
	}
}

country_event = {
	id = GER_sapd_left_opposition.1
	title = GER_sapd_left_opposition.1.t
	desc = GER_sapd_left_opposition.1.desc
	picture = GFX_kpd_ralley

	is_triggered_only = yes

	option = {
		name = GER_sapd_left_opposition.1.ban
		custom_effect_tooltip = GER_sapd_ban_kpd_tt
		add_stability = 0.03
		add_popularity = {
			ideology = communism
			popularity = -0.05
		}
		add_ideas = GER_sapd_far_left_suppression
	}
	option = {
		name = GER_sapd_left_opposition.1.legalize
		set_country_flag = GER_sapd_legalize_kpd
		custom_effect_tooltip = GER_sapd_legalize_kpd_tt
		add_stability = -0.02
		add_popularity = {
			ideology = communism
			popularity = 0.05
		}
	}
	option = {
		name = GER_sapd_left_opposition.1.integrate
		custom_effect_tooltip = GER_sapd_integrate_kpd_tt
		add_stability = -0.10
		add_popularity = {
			ideology = communism
			popularity = 0.20
		}
		set_power_balance = {
			id = GER_kpd_sapd_balance
			set_default = yes
		}
		set_country_flag = GER_sapd_kpd_integrated
	}
}
country_event = {
	id = GER_sapd_left_opposition.2
	title = GER_sapd_left_opposition.2.t
	desc = GER_sapd_left_opposition.2.desc
	picture = GFX_kpd_council

	fire_only_once = yes
	mean_time_to_happen = {
		days = 30
	}

	trigger = {
		power_balance_value = {
			id = GER_kpd_sapd_balance
			value < -0.25
		}
	}

	option = {
		name = GER_sapd_left_opposition.2.strengthen_kpd
		custom_effect_tooltip = GER_sapd_left_opposition.2.strengthen_kpd_tt
		add_power_balance_value = {
			id = GER_kpd_sapd_balance
			value = -0.20
		}
	}
	option = {
		name = GER_sapd_left_opposition.2.weaken_kpd
		add_power_balance_value = {
			id = GER_kpd_sapd_balance
			value = 0.20
		}
	}
}
country_event = {
	id = GER_sapd_left_opposition.3
	title = GER_sapd_left_opposition.3.t
	desc = GER_sapd_left_opposition.3.desc
	picture = GFX_ernst_thaelmann

	fire_only_once = yes
	mean_time_to_happen = {
		days = 30
	}

	trigger = {
		power_balance_value = {
			id = GER_kpd_sapd_balance
			value < -0.50
		}
	}

	option = {
		name = GER_sapd_left_opposition.3.kpd_chancellor
		custom_effect_tooltip = GER_sapd_left_opposition.3.kpd_chancellor_tt
		add_power_balance_value = {
			id = GER_kpd_sapd_balance
			value = -0.50
		}
	}
	option = {
		name = GER_sapd_left_opposition.3.sapd_chancellor
		add_power_balance_value = {
			id = GER_kpd_sapd_balance
			value = 0.25
		}
	}
}
country_event = {
	id = GER_sapd_left_opposition.4
	title = GER_sapd_left_opposition.4.t
	desc = GER_sapd_left_opposition.4.desc
	picture = GFX_kpd_march

	fire_only_once = yes
	mean_time_to_happen = {
		days = 60
	}

	trigger = {
		power_balance_value = {
			id = GER_kpd_sapd_balance
			value < -0.90
		}
	}

	option = {
		name = GER_sapd_left_opposition.4.no_choice
		complete_national_focus = GER_kpd_coup
		set_politics = {
			ruling_party = communism
		}
		add_popularity = {
			ideology = communism
			popularity = 0.30
		}
		set_party_name = {
			ideology = communism
			long_name = GER_rework_kpd_long
			name = GER_rework_kpd
		}
		set_cosmetic_tag = GER_KPD
		mark_focus_tree_layout_dirty = yes
	}
}

country_event = {
	id = GER_stance_on_versailles.1
	title = GER_stance_on_versailles.1.t
	desc = GER_stance_on_versailles.1.desc
	picture = GFX_treaty_of_versailles

	is_triggered_only = yes

	option = {
		name = GER_stance_on_versailles.1.reconciliation
		set_country_flag = GER_versailles_reconciliation
	}
	option = {
		name = GER_stance_on_versailles.1.opposition
		set_country_flag = GER_versailles_opposition
	}
}