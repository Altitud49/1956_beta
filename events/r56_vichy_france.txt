###########################
# axis minors events
###########################
## add claims on north africa for france, make a more dynamic system for cores for Vichy
##ensure FRA annex VIC if it capitulates
add_namespace = axis_minors_vichy_france

#event to identify vichy france
#country_event = {
#	id = axis_minors_vichy_france.1
#	title = axis_minors_vichy_france.1.t
#	desc = axis_minors_vichy_france.1.desc
#	picture = GFX_report_event_pierre_laval
#	
#	trigger = {
#		
#		has_country_flag = is_vichy_france
#		
#		# check if  vichy, has Pétain as leader, is in a civil war, war against france
#		ROOT = { has_civil_war = yes }
#		FRA = { has_civil_war = yes }
#		has_war_with = FRA
#		has_global_flag = fall_of_france
#		has_country_leader = { ruling_only = no name = "Philippe Pétain" } 
#	}
#	mean_time_to_happen = {
#			days = 2
#		}
#	fire_only_once = yes	
#	option = {
#		name = axis_minors_vichy_france.1.a
#		ai_chance = {
#			factor = 100
#		}
#		set_cosmetic_tag = FRA_VIC	
#		set_country_flag = is_vichy_france
#	}	
#}

#country_event = { #ensure that Free France has the right territories
#	id = axis_minors_vichy_france.2
#	title = axis_minors_vichy_france.2.t
#	desc = axis_minors_vichy_france.2.desc
#	picture = GFX_report_event_french_liberation
#	
#	trigger = {
#		tag = FRA
#		has_global_flag = fall_of_france
#		has_capitulated = yes
#		has_country_leader = { ruling_only = no name = "Charles de Gaulle" } 
#	}
#	mean_time_to_happen = {
#			days = 1
#		}
#	fire_only_once = yes	
#	option = {
#		name = axis_minors_vichy_france.2.a
#		ai_chance = {
#			factor = 100
#		}
#		set_state_controller = 515
#		set_state_controller = 660
#		set_state_controller = 539
#		set_capital = 539
#	}	
#}

country_event = { #annexation of VIC by FRA if liberation
	id = axis_minors_vichy_france.3
	title = axis_minors_vichy_france.3.t
	desc = axis_minors_vichy_france.3.desc
	picture = GFX_report_event_french_liberation
	
	trigger = {
		tag = FRA
		
		has_global_flag = fall_of_france
		
		VIC = {
			has_capitulated = yes
		}
	}
	mean_time_to_happen = {
			days = 2
		}
	fire_only_once = yes	
	option = {
		name = axis_minors_vichy_france.3.a
		ai_chance = {
			factor = 100
		}
		annex_country = { target = VIC } 
		every_state = { 
			limit = {
				is_core_of = VIC
			}
			remove_core_of = VIC
		}		
		set_capital = { state = 16 }
	}	
}

country_event = { #Juin defects
	id = axis_minors_vichy_france.4
	title = axis_minors_vichy_france.4.t
	desc = axis_minors_vichy_france.4.desc
	picture = GFX_report_event_french_liberation
	
	fire_only_once = yes
	
	trigger = {
		tag = FRA
		#NOT = {
		#	#has_country_flag = juin_commander
		#	FRA_alphonse_juin = {
		#		is_army_leader = yes
		#	}
		#}
		VIC = {
			#OR = {
			#	has_completed_focus = VIC_negociate_the_release_of_officers
			#	has_completed_focus = EFR_negociate_the_release_of_officers
			#}
			has_character = FRA_alphonse_juin
			FRA_alphonse_juin = {
				is_army_leader = yes
			}
		}		
		OR = {
			AND = {
				#algiers
				controls_state = 459
				#morocco
				controls_state = 461
			}
			#metropolitan france  (without corsica for gameplay reasons)
			controls_state = 14
			controls_state = 15
			controls_state = 29
			controls_state = 30
			controls_state = 24
			controls_state = 27
			controls_state = 18
			controls_state = 17
			controls_state = 28
			controls_state = 33
			controls_state = 23
			controls_state = 25
			controls_state = 26
			controls_state = 20
			controls_state = 19
			controls_state = 31
			controls_state = 22
			controls_state = 21
			controls_state = 32
			controls_state = 735	
		}
		has_global_flag = fall_of_france 
	}
	mean_time_to_happen = {
		days = 270
	}
	option = {
		name = axis_minors_vichy_france.4.a
		ai_chance = {
			factor = 100
		}
		#if = {
		#	limit = {
		#		VIC = {
		#			has_character = FRA_alphonse_juin
		#		}
		#	}
			VIC = {
				FRA_alphonse_juin = {
					set_nationality = FRA
				}
			}
		#}
		
		#add_corps_commander_role = {
		#	character = FRA_alphonse_juin
		#	traits={ career_officer trait_cautious armor_officer }
		#	skill=4
		#	attack_skill=3
		#	defense_skill=2
		#	planning_skill=4
		#	logistics_skill=4
		#	legacy_id=0
		#}
		VIC = {
			country_event = { id = axis_minors_vichy_france.5 } 
		}

		#set_country_flag = juin_defected
	}	
}

country_event = { #Tell VIC Juin defects
	id = axis_minors_vichy_france.5
	title = axis_minors_vichy_france.5.t
	desc = axis_minors_vichy_france.5.desc
	picture = GFX_report_event_french_liberation
	
	is_triggered_only = yes
	fire_only_once = yes	
	option = {
		name = axis_minors_vichy_france.5.a
		ai_chance = {
			factor = 100
		}
	}	
}

country_event = { # Delattre critical of the situation
	id = axis_minors_vichy_france.6
	title = axis_minors_vichy_france.6.t
	desc = axis_minors_vichy_france.6.desc
	picture = GFX_report_event_french_liberation
	
	trigger = {
		has_country_flag = is_vichy_france
		OR = {
			NOT = {
				AND = {
					#algiers
					controls_state = 459
					#morocco
					controls_state = 461
				}
				#metropolitan france  (without corsica for gameplay reasons)
				controls_state = 14
				controls_state = 15
				controls_state = 29
				controls_state = 30
				controls_state = 24
				controls_state = 27
				controls_state = 18
				controls_state = 17
				controls_state = 28
				controls_state = 33
				controls_state = 23
				controls_state = 25
				controls_state = 26
				controls_state = 20
				controls_state = 19
				controls_state = 31
				controls_state = 22
				controls_state = 21
				controls_state = 32
				controls_state = 735	
			}
		}
		has_global_flag = fall_of_france
		has_character = FRA_jean_de_lattre_de_tassigny
		FRA_jean_de_lattre_de_tassigny = {
			NOT = {
				has_character_flag = delattre_betrayed
			}
		}
		#NOT = { has_country_flag = delattre_betrayed }
	}
	
	mean_time_to_happen = {
		days = 243
	}
	
	fire_only_once = yes
	
	option = {
		name = axis_minors_vichy_france.6.a
		ai_chance = {
			factor = 100
		}
		FRA_jean_de_lattre_de_tassigny = {
			set_character_flag = delattre_imprisonned
		}
		#set_country_flag = delattre_imprisonned
		add_political_power  = -10

	}
	option = {
		name = axis_minors_vichy_france.6.b
		ai_chance = {
			factor = 0
		}
		FRA_jean_de_lattre_de_tassigny = {
			set_character_flag = delattre_free
		}
		#set_country_flag = delattre_free
		add_political_power  = -50
	}	
}

country_event = { # Delattre tries to escape from prison
	id = axis_minors_vichy_france.7
	title = axis_minors_vichy_france.7.t
	desc = axis_minors_vichy_france.7.desc
	picture = GFX_report_event_french_liberation
	
	trigger = {
		has_country_flag = is_vichy_france
		has_character = FRA_jean_de_lattre_de_tassigny
		FRA_jean_de_lattre_de_tassigny = {
			has_character_flag = delattre_imprisonned
		}
		#has_country_flag = delattre_imprisonned
	}
	
	mean_time_to_happen = {
		days = 295
	}
	
	fire_only_once = yes	
	
	option = {
		name = axis_minors_vichy_france.7.a
		ai_chance = {
			factor = 100
		}
		random_list = { #result of the evasion attempt, success 80%, killed 10% remain in prison 10%
			80 = {
				FRA_jean_de_lattre_de_tassigny = {
					clr_character_flag = delattre_imprisonned
					set_character_flag = delattre_free
				}
				#clr_country_flag = delattre_imprisonned
				#set_country_flag = delattre_free
				#VIC = { 
					country_event = {
						id = axis_minors_vichy_france.8 
					}
				#}

			}
			10 = {
				FRA_jean_de_lattre_de_tassigny = {
					clr_character_flag = delattre_imprisonned
					set_character_flag = delattre_died
				} 	
				#clr_country_flag = delattre_imprisonned
				#set_country_flag = delattre_died
				#VIC = { 
					country_event = {
						id = axis_minors_vichy_france.10
					} 
				#}
			}
			10 = { 				
				
			}
		}
	}	
}

country_event = { #Delattre defects
	id = axis_minors_vichy_france.8
	title = axis_minors_vichy_france.8.t
	desc = axis_minors_vichy_france.8.desc
	picture = GFX_report_event_french_liberation
	
	fire_only_once = yes
	
	trigger = {
		has_country_flag = is_vichy_france
		has_character = FRA_jean_de_lattre_de_tassigny
		FRA_jean_de_lattre_de_tassigny = {
			has_character_flag = delattre_free
		}
		#has_country_flag = delattre_free
	}	
	
	mean_time_to_happen = {
		days = 148
	}
	
	immediate = {
		hidden_effect = {
			FRA_jean_de_lattre_de_tassigny = {
				set_character_flag = delattre_betrayed
			}
			#set_country_flag = delattre_betrayed
			#VIC = {
				FRA_jean_de_lattre_de_tassigny = {
					set_nationality = FRA
				}
			#}
		}
	}
	
	option = {
		name = axis_minors_vichy_france.8.a
		ai_chance = {
			factor = 100
		}
		
		FRA = {
			country_event = { id = axis_minors_vichy_france.9 } 
		}		
	}	
}

country_event = { #Delattre de Tassigny defects, De Gaulle point of view
	id = axis_minors_vichy_france.9
	title = axis_minors_vichy_france.9.t
	desc = axis_minors_vichy_france.9.desc
	picture = GFX_report_event_french_liberation
	
	is_triggered_only = yes
	fire_only_once = yes	
	option = {
		name = axis_minors_vichy_france.9.a
		ai_chance = {
			factor = 100
		}
		effect_tooltip = {
			VIC = {
				FRA_jean_de_lattre_de_tassigny = {
					set_nationality = FRA
				}
			}
		}
	}	
}

country_event = { #Delattre dies while attempting to escape from his jail
	id = axis_minors_vichy_france.10
	title = axis_minors_vichy_france.10.t
	desc = axis_minors_vichy_france.10.desc
	picture = GFX_report_event_french_liberation
	
	is_triggered_only = yes	
	option = {
		name = axis_minors_vichy_france.10.a
		ai_chance = {
			factor = 100
		}		
		FRA = {
			country_event = { id = axis_minors_vichy_france.11 } 
		}
	}	
}
country_event = { #Delattre Dies while attempting to escape from his jail
	id = axis_minors_vichy_france.11
	title = axis_minors_vichy_france.11.t
	desc = axis_minors_vichy_france.11.desc
	picture = GFX_report_event_french_liberation
	
	is_triggered_only = yes	
	option = { #a martyr
		name = axis_minors_vichy_france.11.a
		ai_chance = {
			factor = 100
		}
		VIC = {
			retire_character = FRA_jean_de_lattre_de_tassigny
		}
	}	
}

country_event = { #war continues: france gets talented new officers, 1st de lattre
	id = axis_minors_vichy_france.12
	title = axis_minors_vichy_france.12.t
	desc = axis_minors_vichy_france.12.desc
	picture = GFX_report_event_french_liberation
	
	trigger = {
		OR = {
			tag = FRA
			has_cosmetic_tag = FRA_UK 
		}
		
		#NOT = {
		#	has_country_flag = de_lattre_commander
		#}
		NOT = {
			FRA_jean_de_lattre_de_tassigny = {
				is_army_leader = yes
			}
		}
		OR = {
			has_global_flag = germany_refused_second_armistice
			AND = {
				date > 1942.1.1
				OR = {
					controls_state = 14
					controls_state = 15
					controls_state = 29
					controls_state = 30
					controls_state = 24
					controls_state = 27
					controls_state = 18
					controls_state = 17
					controls_state = 28
					controls_state = 33
					controls_state = 23
					controls_state = 25
					controls_state = 26
					controls_state = 20
					controls_state = 19
					controls_state = 31
					controls_state = 22
					controls_state = 21
					controls_state = 32
					controls_state = 735				
				}
			}
		}
	}
	
	mean_time_to_happen = {
		days = 212
	}
	fire_only_once = yes
	option = { #
		name = axis_minors_vichy_france.12.a
		ai_chance = {
			factor = 100
		}
		add_corps_commander_role = { ## imprisonned when south was invaded then joins De Gaulle
			character = FRA_jean_de_lattre_de_tassigny
			traits={ brilliant_strategist cavalry_officer war_hero trickster }
			skill=4
			attack_skill=4
			defense_skill=2
			planning_skill=4
			logistics_skill=3
			legacy_id=0
		}
		#set_country_flag = de_lattre_commander
	}	
}
country_event = { #war continues: france gets talented new officers, 2nd, Leclerc
	id = axis_minors_vichy_france.13
	title = axis_minors_vichy_france.13.t
	desc = axis_minors_vichy_france.12.desc
	picture = GFX_report_event_french_liberation
	
	trigger = {
		tag = FRA
		#NOT = {
		#	has_country_flag = leclerc_commander
		#}
		NOT = {
			FRA_philippe_leclerc = {
				is_army_leader = yes
			}
		}
		OR = {
			has_global_flag = germany_refused_second_armistice
			AND = {
				date > 1941.1.1
				OR = {
					controls_state = 14
					controls_state = 15
					controls_state = 29
					controls_state = 30
					controls_state = 24
					controls_state = 27
					controls_state = 18
					controls_state = 17
					controls_state = 28
					controls_state = 33
					controls_state = 23
					controls_state = 25
					controls_state = 26
					controls_state = 20
					controls_state = 19
					controls_state = 31
					controls_state = 22
					controls_state = 21
					controls_state = 32
					controls_state = 735				
				}
			}
		}
	}	
	
	mean_time_to_happen = {
		days = 120
	}
	fire_only_once = yes
	option = { #
		name = axis_minors_vichy_france.12.a
		ai_chance = {
			factor = 100
		}
		add_corps_commander_role = {
			character = FRA_philippe_leclerc
			traits = { career_officer trait_reckless armor_officer }
			skill = 3
			attack_skill = 3
			defense_skill = 2
			planning_skill = 2
			logistics_skill = 3
		}
		army_experience = 5	
		#set_country_flag = leclerc_commander
	}	
}

country_event = { #war continues: france gets talented new officers, 3rd, Juin
	id = axis_minors_vichy_france.14
	title = axis_minors_vichy_france.14.t
	desc = axis_minors_vichy_france.12.desc
	picture = GFX_report_event_french_liberation

	trigger = {
		tag = FRA
		NOT = {
			#has_country_flag = juin_commander
			FRA_alphonse_juin = {
				is_army_leader = yes
			}
			#has_country_flag = juin_defected
		}
		OR = {
			has_global_flag = germany_refused_second_armistice
			AND = {
				date > 1941.1.1
				OR = {
					controls_state = 14
					controls_state = 15
					controls_state = 29
					controls_state = 30
					controls_state = 24
					controls_state = 27
					controls_state = 18
					controls_state = 17
					controls_state = 28
					controls_state = 33
					controls_state = 23
					controls_state = 25
					controls_state = 26
					controls_state = 20
					controls_state = 19
					controls_state = 31
					controls_state = 22
					controls_state = 21
					controls_state = 32
					controls_state = 735				
				}
			}
		}
	}
	
	mean_time_to_happen = {
		days = 200
	}
	fire_only_once = yes
	option = { #
		name = axis_minors_vichy_france.12.a
		ai_chance = {
			factor = 100
		}
		add_corps_commander_role = {
			character = FRA_alphonse_juin
			traits={ career_officer trait_cautious armor_officer }
			skill=4
			attack_skill=3
			defense_skill=2
			planning_skill=4
			logistics_skill=4
			legacy_id=0
		}
		army_experience = 5	
		#set_country_flag = juin_commander
	}	
}

country_event = { #war continues: france gets talented new officers, 4th Koenig
	id = axis_minors_vichy_france.15
	title = axis_minors_vichy_france.12.t
	desc = axis_minors_vichy_france.12.desc
	picture = GFX_report_event_french_liberation

	trigger = {
		tag = FRA
		OR = {
			has_global_flag = germany_refused_second_armistice
			AND = {
				date > 1940.11.21
				has_war = yes
			}
			date > 1941.6.12
		}
		NOT = {
			#has_country_flag = koenig_commander
			FRA_marie_pierre_koenig = {
				is_army_leader = yes
			}
		}
	}
	
	mean_time_to_happen = {
		days = 220
	}
	fire_only_once = yes
	option = { #
		name = axis_minors_vichy_france.12.a
		ai_chance = {
			factor = 100
		}
		add_corps_commander_role = {
			character = FRA_marie_pierre_koenig
			traits = { trickster meticulous }
			skill = 3
			attack_skill = 2
			defense_skill = 2
			planning_skill = 3
			logistics_skill = 3
		}
		army_experience = 5		
		#set_country_flag = koenig_commander
	}	
}

country_event = { #war continues: france gets talented new officers, 5th De Gaulle
	id = axis_minors_vichy_france.16
	title = axis_minors_vichy_france.12.t
	desc = axis_minors_vichy_france.12.desc
	picture = GFX_report_event_french_liberation
	
	mean_time_to_happen = {
		days = 52
	}
	trigger = {
		tag = FRA
		NOT = {
			#has_country_flag = de_gaulle_commander
			FRA_charles_de_gaulle = {
				is_army_leader = yes
			}
		}
		OR = {
			has_global_flag = germany_refused_second_armistice
			AND = {
				date > 1940.9.1
				has_war = yes
			}
			date > 1941.2.12
		}
	}
	fire_only_once = yes
	option = { #
		name = axis_minors_vichy_france.12.a
		ai_chance = {
			factor = 100
		}
		add_corps_commander_role = {
			character = FRA_charles_de_gaulle
			traits = {  panzer_leader armor_officer harsh_leader media_personality }
			skill = 4
			attack_skill = 4
			defense_skill = 4
			planning_skill = 3
			logistics_skill = 2
		}
		army_experience = 5	
		#set_country_flag = de_gaulle_commander
	}	
}

country_event = { #event to stabilize the northern occupation zone and the border with Vichy France, expand later to take into account the restauration of France in the new european order
	id = axis_minors_vichy_france.17
	title = axis_minors_vichy_france.17.t
	desc = axis_minors_vichy_france.17.desc
	picture = GFX_report_event_pierre_laval
	
	trigger = {
		has_country_flag = is_vichy_france
		OR = {
			is_subject_of = GER
			is_guaranteed_by = GER
		}
		OR = {
			#metropolitan france  (without corsica for gameplay reasons)
			controls_state = 14
			controls_state = 15
			controls_state = 17
			controls_state = 18
			controls_state = 19
			controls_state = 23
			controls_state = 24
			controls_state = 27
			controls_state = 28
			controls_state = 29
			controls_state = 30
		}
		
		NOT = { has_dlc = "La Resistance" } #with LaR you can get northern france with a focus event
	}
	
	mean_time_to_happen = {
		days = 2
	}	
	
	option = {
		name = axis_minors_vichy_france.17.a
		ai_chance = {
			factor = 100
		}
		if = {
			limit = {
				14 = {
					OR = {
						is_controlled_by = VIC
					}
				}
			}
			GER = { set_state_controller = 14 }
		}
		if = {
			limit = {
				15 = {
					OR = {
						is_controlled_by = VIC
					}
				}
			}
			GER = { set_state_controller = 15 }
		}
		if = {
			limit = {
				17 = {
					OR = {
						is_controlled_by = VIC
					}
				}
			}
			GER = { set_state_controller = 17 }
		}
		if = {
			limit = {
				18 = {
					OR = {
						is_controlled_by = VIC
					}
				}
			}
			GER = { set_state_controller = 18 }
		}
		if = {
			limit = {
				19 = {
					OR = {
						is_controlled_by = VIC
					}
				}
			}
			GER = { set_state_controller = 19 }
		}
		if = {
			limit = {
				23 = {
					OR = {
						is_controlled_by = VIC
					}
				}
			}
			GER = { set_state_controller = 23 }
		}
		if = {
			limit = {
				24 = {
					OR = {
						is_controlled_by = VIC
					}
				}
			}
			GER = { set_state_controller = 24 }
		}
		if = {
			limit = {
				27 = {
					OR = {
						is_controlled_by = VIC
					}
				}
			}
			GER = { set_state_controller = 27 }
		}
		if = {
			limit = {
				28 = {
					OR = {
						is_controlled_by = VIC
					}
				}
			}
			GER = { set_state_controller = 28 }
		}
		if = {
			limit = {
				29 = {
					OR = {
						is_controlled_by = VIC
					}
				}
			}
			GER = { set_state_controller = 29 }
		}
		if = {
			limit = {
				30 = {
					OR = {
						is_controlled_by = VIC
					}
				}
			}
			GER = { set_state_controller = 30 }
		}		
	}	
}

#country_event = { #hide equipment from the Germans
#	id = axis_minors_vichy_france.18
#	title = axis_minors_vichy_france.18.t
#	desc = axis_minors_vichy_france.18.desc
#	picture = GFX_report_event_pierre_laval
#	is_triggered_only = yes
#	
#	option = {
#		name = axis_minors_vichy_france.18.a
#		ai_chance = {
#			factor = 100
#		}
#		#5 weapon caches of infantry equipment 1 and support equipment, weapons should ends up in the hands of Vichy, free france or the resistance (boost partisan activity or free units for France in the vercors and maybe near Paris)
#		set_global_flag = vichy_weapon_cache_1
#		set_global_flag = vichy_weapon_cache_2
#		set_global_flag = vichy_weapon_cache_3
#		set_global_flag = vichy_weapon_cache_4
#		set_global_flag = vichy_weapon_cache_5
#		add_ideas = {
#			idea_EFR_hidden_rifles
#		}
#	}
#	option = { #scrap the plan
#		name = axis_minors_vichy_france.18.b
#		ai_chance = {
#			factor = 100
#		}
#	}	
#}

#annex the free zone if Vichy loses the empire is lost
#country_event = { 
#	id = axis_minors_vichy_france.19
#	title = axis_minors_vichy_france.19.t
#	desc = axis_minors_vichy_france.19.desc
#	picture = GFX_report_event_pierre_laval
	
#	mean_time_to_happen = {
#		days = 10
#	}	
#	trigger = {
#		tag = GER
#		VIC = {
#			is_subject_of = GER
#			NOT = {	 
#				#algiers
#				controls_state = 459
#				#morocco
#				controls_state = 461
#				#french west africa
#				controls_state = 556
#				#Gabon
#				controls_state = 559	
#				#Dakar
#				controls_state = 272
#			}
#		}
#	}
#	option = { #launch operation Anton
#		name = axis_minors_vichy_france.19.a
#		ai_chance = {
#			factor = 90
#		}
#		VIC = {
#			country_event = { id = axis_minors_vichy_france.20 } 
#		}
#	}		
#	option = { #keep faith in Vichy
#		name = axis_minors_vichy_france.19.b
#		ai_chance = {
#			factor = 10
#		}
#	}		
#}

country_event = { #germany wants to invade the free zone, Pétain's reaction
	id = axis_minors_vichy_france.20
	title = axis_minors_vichy_france.20.t
	desc = axis_minors_vichy_france.20.desc
	picture = GFX_report_event_pierre_laval
	
	is_triggered_only =yes
	
	option = { #historical choice, no resistance
		name = axis_minors_vichy_france.20.a
		ai_chance = {
			factor = 95
		}
		####marquer par des if les états de Vichy, si controlé par l'allemagne ou un pays dans une faction avec l'allemagne, changer le possesseur mais pas remettre le controle a l'allemagne.
		## controler par une autre faction, remettre le contrôle a cette faction?? Si contrôlé par la France, remettre le contrôle à la France
		if = {
			limit = {
				NOT = {
					tag = VIC
				}
				controls_state = 1
				controls_state = 14
				controls_state = 15
				controls_state = 17
				controls_state = 18
				controls_state = 19
				controls_state = 20
				controls_state = 21
				controls_state = 22
				controls_state = 23
				controls_state = 24
				controls_state = 25
				controls_state = 26
				controls_state = 27
				controls_state = 28
				controls_state = 29
				controls_state = 30
				controls_state = 31
				controls_state = 32
				controls_state = 33
				controls_state = 735
				OR = {
					tag = GER
					AND = {
						is_in_faction_with = GER
						NOT = { tag = VIC }
					}	
				}			
			}
			else = {
				if = {
					limit = {
						1 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 1 }
					GER = { set_state_controller = 1 }	
				}
				if = {
					limit = {
						14 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 14 }
					GER = { set_state_controller = 14 }	
				}
				if = {
					limit = {
						15 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 15 }
					GER = { set_state_controller = 15 }	
				}
				if = {
					limit = {
						17 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 17 }
					GER = { set_state_controller = 17 }	
				}
				if = {
					limit = {
						18 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 18 }
					GER = { set_state_controller = 18 }	
				}
				if = {
					limit = {
						19 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 19 }
					GER = { set_state_controller = 19 }	
				}
				if = {
					limit = {
						20 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 20 }
					GER = { set_state_controller = 20 }	
				}
				if = {
					limit = {
						21 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 21 }
					GER = { set_state_controller = 21 }	
				}
				if = {
					limit = {
						22 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 22 }
					GER = { set_state_controller = 22 }	
				}
				if = {
					limit = {
						23 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 23 }
					GER = { set_state_controller = 23 }	
				}
				if = {
					limit = {
						24 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 24 }
					GER = { set_state_controller = 24 }	
				}
				if = {
					limit = {
						25 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 25 }
					GER = { set_state_controller = 25 }	
				}
				if = {
					limit = {
						26 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 26 }
					GER = { set_state_controller = 26 }	
				}
				if = {
					limit = {
						27 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 27 }
					GER = { set_state_controller = 27 }	
				}
				if = {
					limit = {
						28 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 28 }
					GER = { set_state_controller = 28 }	
				}
				if = {
					limit = {
						29 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 29 }
					GER = { set_state_controller = 29 }	
				}
				if = {
					limit = {
						30 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 30 }
					GER = { set_state_controller = 30 }	
				}
				if = {
					limit = {
						31 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 31 }
					GER = { set_state_controller = 31 }	
				}
				if = {
					limit = {
						32 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 32 }
					GER = { set_state_controller = 32 }	
				}
				if = {
					limit = {
						33 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 33 }
					GER = { set_state_controller = 33 }	
				}
				if = {
					limit = {
						735 = {
							is_controlled_by = VIC
						}
					}
					FRA = { set_state_owner = 735 }
					GER = { set_state_controller = 735 }	
				}				
			}
		}
		custom_effect_tooltip = GAME_OVER_TT
	}		
	option = { #resist?
		name = axis_minors_vichy_france.20.b
		ai_chance = {
			factor = 0
		}
	}
	option = { #Petain flees and join De Gaulle -- ADD EVENT FOR FREE FRANCE AND NEWS EVENT TOO
		name = axis_minors_vichy_france.20.c
		ai_chance = {
			factor = 5
		}
		FRA = {
			annex_country = { target = VIC } 
			every_state = { 
				limit = {
					is_core_of = VIC
				}
				remove_core_of = VIC
			}
		}	
		custom_effect_tooltip = GAME_OVER_TT
	}
	option = { #Human Player uses diplomacy to continue collaboration
		name = axis_minors_vichy_france.20.d
		ai_chance = {
			factor = 0
		}
	}	
}

#Swing and jerries
country_event = { 
	id = axis_minors_vichy_france.21
	title = axis_minors_vichy_france.21.t
	desc = axis_minors_vichy_france.21.desc
	picture = GFX_report_event_zazou_dance
	fire_only_once = yes
	mean_time_to_happen = {
		days = 104
	}	
	trigger = {
		has_country_flag = is_vichy_france
		#tag = VIC
		has_government = fascism
	}
	option = { #blast
		name = axis_minors_vichy_france.21.a
		ai_chance = {
			factor = 100
		}
		add_political_power = -20
		add_popularity = {
			ideology = democratic
			popularity = 0.03
		}		
		#reduce balance
	}		
}

add_namespace = axis_minors_vichy_france_ai_strategy

country_event = {
	id = axis_minors_vichy_france_ai_strategy.1
	title = axis_minors_vichy_france_ai_strategy.1.t
	desc = axis_minors_vichy_france_ai_strategy.1.desc
	picture = GFX_report_event_french_liberation
	hidden = yes
	is_triggered_only = yes
	fire_only_once = yes
	
	immediate = {
		add_ai_strategy = {
			type = alliance
			id = GER
			value = 200
		}
	}
	
	option = {
		name = axis_minors_vichy_france_ai_strategy.1.a
		ai_chance = {
			factor = 100
		}
	}	
}

add_namespace = axis_minors_vichy_france_darlan_influence

country_event = {
	id = axis_minors_vichy_france_darlan_influence.1
	title = axis_minors_vichy_france_darlan_influence.1.t
	desc = axis_minors_vichy_france_darlan_influence.1.desc
	picture = GFX_report_event_france_darlan_and_petain
	
	is_triggered_only = yes

	fire_only_once = yes

	option = { #GOOD TO KNOW, THANKS
		name = axis_minors_vichy_france_darlan_influence.1.a
		
		set_country_flag = vic_start_darlan_decisions
		unlock_decision_category_tooltip = VIC_darlan_influence
	}
}

add_namespace = axis_minors_vichy_operation_torch

country_event = {
	id = axis_minors_vichy_operation_torch.1
	hidden = yes
	trigger = {
		#tag = VIC
		has_country_flag = is_vichy_france
		OR = {
			has_war_with = USA
			has_war_with = ENG
		}
		has_war_with = FRA
		
		#Lost Control of North Africa
		custom_trigger_tooltip = {
			tooltip = GER_case_anton_tt2
			count_triggers = {
				amount = 3 # lost control of over half french north africa
				if = {
					limit = {
						458 = {
							is_owned_by = VIC
						}
					}
					458 = { CONTROLLER = { has_war_with = ROOT } }
				}
				if = {
					limit = {
						665 = {
							is_owned_by = VIC
						}
					}
					665 = { CONTROLLER = { has_war_with = ROOT } }
				}
				
				#458 = { CONTROLLER = { has_war_with = ROOT } } #Tunisia should be italian
				459 = { CONTROLLER = { has_war_with = ROOT } }
				460 = { CONTROLLER = { has_war_with = ROOT } }
				461 = { CONTROLLER = { has_war_with = ROOT } }
				462 = { CONTROLLER = { has_war_with = ROOT } }
				513 = { CONTROLLER = { has_war_with = ROOT } }
				860 = { CONTROLLER = { has_war_with = ROOT } }
				#665 = { CONTROLLER = { has_war_with = ROOT } } #Tunisia should be italian
			}
		}
		
		has_character = FRA_françois_darlan
		NOT = { has_country_leader = { character = FRA_françois_darlan ruling_only = yes } }
		
		#Darlan is influential but not powerful
		check_variable = { var = darlan_influence value = 20 compare = greater_than_or_equals }
		check_variable = { var = darlan_influence value = 35 compare = less_than }
		
		always = no
	}
	mean_time_to_happen = { days = 2 }
	immediate = {
		country_event = {
			id = axis_minors_vichy_france_darlan_deal.1
		}
	}
}

add_namespace = axis_minors_vichy_france_darlan_deal

#Darlan Deal
country_event = { 
	id = axis_minors_vichy_france_darlan_deal.1
	title = axis_minors_vichy_france_darlan_deal.1.t
	desc = axis_minors_vichy_france_darlan_deal.1.desc
	picture = GFX_report_event_france_darlan_eisenhower
	
	is_triggered_only = yes
	immediate = {
		
	}
	
	#Give up Fighting in Africa
	option = {
		name = axis_minors_vichy_france_darlan_deal.1.a
		ai_chance = {
			factor = 80
		}
		add_war_support = 0.1
		remove_ideas = VIC_vichyite_neutrality
		GER = {
			add_to_faction = VIC
		}
		add_to_war = {
			targeted_alliance = GER
			enemy = FRA
			hostility_reason = asked_to_join
		}
		if = {
			limit = {
				460 = {
					is_controlled_by_ROOT_or_subject = yes
				}
			}
			460 = {
				create_unit = { 
					division = "name = \"Phalange Africaine\" division_template = \"Division d'Infanterie\" start_experience_factor = 0.3 start_equipment_factor = 0.5" 
					owner = ROOT
				}
				create_unit = { 
					division = "name = \"Phalange Africaine\" division_template = \"Division d'Infanterie\" start_experience_factor = 0.3 start_equipment_factor = 0.5" 
					owner = ROOT
				}
			}
		}
		if = {
			limit = {
				860 = {
					is_controlled_by_ROOT_or_subject = yes
				}
			}
			860 = {
				create_unit = { 
					division = "name = \"Phalange Africaine\" division_template = \"Division d'Infanterie\" start_experience_factor = 0.3 start_equipment_factor = 0.5" 
					owner = ROOT
				}
				create_unit = { 
					division = "name = \"Phalange Africaine\" division_template = \"Division d'Infanterie\" start_experience_factor = 0.3 start_equipment_factor = 0.5" 
					owner = ROOT
				}
			}
		}
		FRA = {
			if = {
				limit = {
					NOT = {
						has_template = "Free French Volunteers"
					}
				}
				division_template = {
					name = "Free French Volunteers"
					division_names_group = FRA_INF_01
					regiments = {
						infantry = { x = 0 y = 0 }
						infantry = { x = 0 y = 1 }
						infantry = { x = 0 y = 2 }

						infantry = { x = 1 y = 0 }
						infantry = { x = 1 y = 1 }
						infantry = { x = 1 y = 2 }
					}
					support = {
						engineer = { x = 0 y = 0 }
					}
				}
			}
			set_state_owner = 460
			set_state_owner = 860
			set_state_owner = 458
			set_state_owner = 665
			
			VIC = {
				set_state_controller = 460
				set_state_controller = 860
				set_state_controller = 458
				set_state_controller = 665
				
				if = {
					limit = {
						459 = {
							is_controlled_by_ROOT_or_subject = yes
						}
					}
					FRA = {
						transfer_state = 459 #algieria
						459 = {
							create_unit = { 
								division = "name = \"Free French Volunteers\" division_template = \"Free French Volunteers\" start_experience_factor = 0.2 start_equipment_factor = 0.5" 
								owner = FRA
							}
							create_unit = { 
								division = "name = \"Free French Volunteers\" division_template = \"Free French Volunteers\" start_experience_factor = 0.2 start_equipment_factor = 0.5" 
								owner = FRA
							}
						}
					}
				}
				if = {
					limit = {
						513 = {
							is_controlled_by_ROOT_or_subject = yes
						}
					}
					FRA = {
						transfer_state = 513 #algiera
						513 = {
							create_unit = { 
								division = "name = \"Free French Volunteers\" division_template = \"Free French Volunteers\" start_experience_factor = 0.2 start_equipment_factor = 0.5" 
								owner = FRA
							}
							create_unit = { 
								division = "name = \"Free French Volunteers\" division_template = \"Free French Volunteers\" start_experience_factor = 0.2 start_equipment_factor = 0.5" 
								owner = FRA
							}
						}
					}
				}
				if = {
					limit = {
						461 = {
							is_controlled_by_ROOT_or_subject = yes
						}
					}
					FRA = {
						transfer_state = 461 #morocco
						461 = {
							create_unit = { 
								division = "name = \"Free French Volunteers\" division_template = \"Free French Volunteers\" start_experience_factor = 0.2 start_equipment_factor = 0.5" 
								owner = FRA
							}
							create_unit = { 
								division = "name = \"Free French Volunteers\" division_template = \"Free French Volunteers\" start_experience_factor = 0.2 start_equipment_factor = 0.5" 
								owner = FRA
							}
						}
					}
				}
				if = {
					limit = {
						462 = {
							is_controlled_by_ROOT_or_subject = yes
						}
					}
					FRA = {
						transfer_state = 462 #morocco
						462 = {
							create_unit = { 
								division = "name = \"Free French Volunteers\" division_template = \"Free French Volunteers\" start_experience_factor = 0.2 start_equipment_factor = 0.5" 
								owner = FRA
							}
							create_unit = { 
								division = "name = \"Free French Volunteers\" division_template = \"Free French Volunteers\" start_experience_factor = 0.2 start_equipment_factor = 0.5" 
								owner = FRA
							}
						}
					}
				}
			
				FRA_françois_darlan = {
					set_nationality = FRA
				}
				
				FRA_henri_giraud = {
					set_nationality = FRA
				}
				FRA_jean_touzet_du_vigier = {
					set_nationality = FRA
				}
				FRA_alphonse_juin = {
					set_nationality = FRA
				}
				FRA_charles_noguès = {
					set_nationality = FRA
				}
				FRA_jean_de_lattre_de_tassigny = {
					set_nationality = FRA
				}
			}
			if = {
				limit = {
					NOT = {
						FRA_alphonse_juin = {
							is_army_leader = yes
						}
					}
				}
				add_corps_commander_role = {
					character = FRA_alphonse_juin
					traits={ career_officer trait_cautious armor_officer }
					skill=4
					attack_skill=3
					defense_skill=2
					planning_skill=4
					logistics_skill=4
					legacy_id=0
				}
			}
			FRA_charles_noguès = {
				retire = yes
			}
			
			#Darlan Assassination
			hidden_effect = {
				random_list = {
					95 = {
						country_event = {
							id = axis_minors_vichy_france_darlan_death.1 days = 30
						}
					}
					5 = {
						country_event = {
							id = axis_minors_vichy_france_darlan_death.2 days = 30
						}
					}
				}
			}
			
			country_event = axis_minors_vichy_france_darlan_deal.2
		}
	}
}

#Free French Notification to Darlan Betrayal
country_event = {
	id = axis_minors_vichy_france_darlan_deal.2
	title = axis_minors_vichy_france_darlan_deal.2.t
	desc = axis_minors_vichy_france_darlan_deal.2.desc
	picture = GFX_report_event_france_darlan_eisenhower
	
	is_triggered_only = yes	
	
	option = {
		name = axis_minors_vichy_france_darlan_deal.2.a
		ai_chance = {
			factor = 100
		}
		effect_tooltip = {
			VIC = {
				FRA_françois_darlan = {
					set_nationality = FRA
				}
				
				FRA_henri_giraud = {
					set_nationality = FRA
				}
				FRA_jean_touzet_du_vigier = {
					set_nationality = FRA
				}
				FRA_alphonse_juin = {
					set_nationality = FRA
				}
				FRA_charles_noguès = {
					set_nationality = FRA
				}
				FRA_jean_de_lattre_de_tassigny = {
					set_nationality = FRA
				}
			}
			if = {
				limit = {
					NOT = {
						FRA_alphonse_juin = {
							is_army_leader = yes
						}
					}
				}
				add_corps_commander_role = {
					character = FRA_alphonse_juin
					traits={ career_officer trait_cautious armor_officer }
					skill=4
					attack_skill=3
					defense_skill=2
					planning_skill=4
					logistics_skill=4
					legacy_id=0
				}
			}
			FRA_charles_noguès = {
				retire = yes
			}
			
			#Darlan Assassination
			hidden_effect = {
				random_list = {
					95 = {
						country_event = {
							id = axis_minors_vichy_france_darlan_death.1 days = 30
						}
					}
					5 = {
						country_event = {
							id = axis_minors_vichy_france_darlan_death.2 days = 30
						}
					}
				}
			}
		}
	}
}

add_namespace = axis_minors_vichy_france_darlan_death

#Darlan dies in Assassination Attempt
country_event = { 
	id = axis_minors_vichy_france_darlan_death.1
	title = axis_minors_vichy_france_darlan_death.1.t
	desc = axis_minors_vichy_france_darlan_death.1.desc
	picture = GFX_report_event_france_darlan_assassinated_news
	
	is_triggered_only = yes	
	
	option = {
		name = axis_minors_vichy_france_darlan_death.1.a
		ai_chance = {
			factor = 100
		}
		retire_character = FRA_françois_darlan
	}
}

#Darlan survives Assassination Attempt
country_event = { 
	id = axis_minors_vichy_france_darlan_death.2
	title = axis_minors_vichy_france_darlan_death.2.t
	desc = axis_minors_vichy_france_darlan_death.2.desc
	picture = GFX_report_event_france_darlan_eisenhower
	
	is_triggered_only = yes	
	
	option = {
		name = axis_minors_vichy_france_darlan_death.2.a
		ai_chance = {
			factor = 100
		}
		
	}
}

add_namespace = axis_minors_vichy_france_deaths

#Chance for Huntziger to die
country_event = {
	id = axis_minors_vichy_france_deaths.1
	title = axis_minors_vichy_france_deaths.1.t
	desc = axis_minors_vichy_france_deaths.1.d
	picture = GFX_report_event_italo_balbo

	fire_only_once = yes

	hidden = yes

	trigger = {
		tag = VIC
		has_war = no
		
		#November 12 , 1941
		date > 1941.6.1
		date < 1941.12.31
	}

	immediate = {
		#in all likelyhood, he dies
		random_list = {
    		80 = {
		        country_event = axis_minors_vichy_france_deaths.2
		    }
		    20 = {

		    }
		}
	}

	option = {
		name = axis_minors_vichy_france_deaths.1.a
	}
}

# Huntziger dies in Plane Crash
country_event = {
	id = axis_minors_vichy_france_deaths.2
	title = axis_minors_vichy_france_deaths.2.t
	desc = axis_minors_vichy_france_deaths.2.desc
	picture = GFX_report_event_generic_rally
	
	fire_only_once = yes
	
	is_triggered_only = yes

	option = {
		name = axis_minors_vichy_france_deaths.2.a
		retire_character = FRA_charles_huntziger
	}
}